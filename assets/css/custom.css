/* =========================================================
   CUSTOM.CSS — CLEAN & CONSOLIDATED
   Keep layout/behavior, remove duplicates, scope overrides
   ========================================================= */

/* ====== QUICK CONFIG ====== */
:root {
  --player-w: 455px;
  --player-h: 520px;
  --player-right: 2rem;
  --stack-gap: 0rem;
  --wrapper-left: 2rem;
  --gap: 1.2rem;
}

/* Avoid horizontal scroll on Chrome when using 100vw */
html, body { overflow-x: clip; }

/* ====== BACKGROUND ====== */
body {
  background: url("../images/bground/background.jpg") no-repeat center/cover fixed;
}

/* ====== LAYOUT ====== */
.page-content { display: flex; justify-content: flex-start; }

/* Blog overlay/card */
.page-content .wrapper {
  width: calc(100vw - var(--player-w) - var(--player-right) - var(--wrapper-left));
  max-width: none !important;
  margin: 2rem var(--gap) 2rem var(--wrapper-left);
  background: rgba(0,0,0,0.98);
  padding: 2.5rem;
  border-radius: 1.2rem;
  box-shadow: 0 6px 20px rgba(0,0,0,0.8);
  overflow: hidden;
  box-sizing: border-box;
  font-size: 1.08rem;
  line-height: 1.7;
}

/* Normalize nested wrappers inside the overlay */
.page-content .wrapper .wrapper,
.page-content .wrapper .site-header .wrapper,
.page-content .wrapper .site-footer .wrapper,
.page-content .wrapper .page-header .wrapper,
.page-content .wrapper .dash-header .wrapper {
  width: 100% !important;
  max-width: none !important;
  margin: 0 !important;
  padding: 0 !important;
  box-sizing: border-box;
}

/* Transparent header/footer bars when placed inside overlay */
.page-content .wrapper .site-header,
.page-content .wrapper .page-header,
.page-content .wrapper .dash-header,
.page-content .wrapper .site-footer {
  background: transparent !important;
  box-shadow: none !important;
  border: 0 !important;
}

/* ====== TYPOGRAPHY ====== */
.page-content .wrapper h1 { font-size: 2.2rem; }
.page-content .wrapper h2 { font-size: 1.6rem; letter-spacing: 0.2px; margin-bottom: 1rem; }
.page-content .wrapper h3 { font-size: 1.25rem; }

.page-content .wrapper .tag,
.page-content .wrapper .post-tag,
.page-content .wrapper .label {
  font-size: 0.92rem;
  padding: 0.25rem 0.6rem;
  border-radius: 0.6rem;
}

.page-content .wrapper .post-meta,
.page-content .wrapper .post__meta { font-size: 0.95rem; }

/* ====== HEADER AVATAR & INTRO ====== */
.page-content .wrapper header img,
.page-content .wrapper .site-header img,
.page-content .wrapper .dash-header img {
  width: 72px; height: 72px; object-fit: cover; border-radius: 12px; margin-right: 12px;
}
.page-content .wrapper header p,
.page-content .wrapper .site-header p,
.page-content .wrapper .dash-header p { font-size: 1.02em; }

/* ====== SPOTIFY CARD ====== */
#spotify-player-wrapper {
  position: fixed;
  bottom: 2rem;
  right: var(--player-right);
  width: var(--player-w);
  height: var(--player-h);
  background: rgba(0,0,0,0.7);
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  border-bottom-left-radius: 1rem;
  border-bottom-right-radius: 1rem;
  box-shadow: 0 4px 16px rgba(0,0,0,0.6);
  overflow: hidden;
  z-index: 1000;
}
#spotify-player-wrapper iframe { width: 100%; height: 100%; border: none; }

/* ====== SCHEDULE BAR (STACKED ABOVE SPOTIFY) ====== */
#schedule-bar {
  position: fixed !important;
  right: var(--player-right);
  bottom: calc(2rem + var(--player-h) + var(--stack-gap));
  width: var(--player-w);
  height: 230px;
  background: rgba(0,0,0,0.85);
  border-top-left-radius: 1rem;
  border-top-right-radius: 1rem;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
  box-shadow: 0 6px 16px rgba(0,0,0,0.6);
  overflow: hidden;
  z-index: 1000;
}
#schedule-bar iframe { width: 100%; height: 100%; border: 0; }

/* ====== MOBILE ====== */
@media (max-width: 600px) {
  #spotify-player-wrapper, #schedule-bar { display: none; }
  .page-content .wrapper { width: 100%; margin: 1rem; max-width: none; }
}

/* ====== SWUP FADE ====== */
.transition-fade { transition: opacity .2s ease; }
html.is-changing .transition-fade { opacity: 0; }

/* ====== WARNING MODAL (SOFT/HARD) ====== */
#warning-modal {
  position: fixed; inset: 0;
  display: none;
  align-items: center; justify-content: center;
  background: rgba(0,0,0,0.66);
  z-index: 1300;
  backdrop-filter: blur(2px);
}
#warning-modal img { display: block; max-width: none; max-height: none; }

#warning-modal.soft {
  background: rgba(0,0,0,0.66);
  padding-inline: 3vw;
  padding-top: max(1.5vh, env(safe-area-inset-top));
  padding-bottom: max(1.5vh, env(safe-area-inset-bottom));
}
#warning-modal.soft img {
  height: 94vh; width: auto;
  object-fit: contain;
  border-radius: 18px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
}

#warning-modal.hard {
  background: rgba(0,0,0,0.9); padding: 0;
  display: flex; align-items: center; justify-content: center;
}
#warning-modal.hard img {
  width: 96vmin; height: auto;
  max-width: 96vw; max-height: 96vh;
  object-fit: contain; border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
}

@media (orientation: portrait) {
  #warning-modal.hard {
    padding: env(safe-area-inset-top) env(safe-area-inset-right)
             env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
  #warning-modal.hard img {
    width: calc(100vw - env(safe-area-inset-left) - env(safe-area-inset-right));
    height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  }
}
@media (max-height: 520px) { #warning-modal.soft img { height: 88vh; } }

body.warn-lock {
  overflow: hidden !important;
  cursor: not-allowed !important;
  user-select: none !important;
}

/* ====== SEARCH BOX ====== */
.recent-articles .recent-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
  padding-right: 2rem;
}
.recent-articles .recent-header h2 {
  margin: 0;
  font-size: 2rem;
  color: #4e8cff;
}
#article-search {
  width: clamp(350px, 60%, 800px);
  padding: 0.6rem 1rem;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 0.5rem;
  background-color: #f5f5f5;
  color: #4e8cff;
  transition: border-color .2s, box-shadow .2s;
}
#article-search::placeholder { color: #a0a0a0; }
#article-search:focus {
  outline: none;
  border-color: #4e8cff;
  box-shadow: 0 0 0 3px rgba(78, 140, 255, 0.3);
}
.article-item.hidden {
  opacity: 0; height: 0; margin: 0; padding: 0; overflow: hidden;
  transition: opacity .3s, height .3s;
}

/* ====== WELCOME MODAL (no flicker base) ====== */
#welcome-overlay, #welcome-modal {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s cubic-bezier(.4,0,.2,1);
  display: none;
}
#welcome-overlay.active {
  opacity: 1;
  pointer-events: auto;
  display: block;
}
#welcome-modal.active {
  opacity: 1;
  pointer-events: auto;
  display: flex;
}

/* Base card (dark theme default) — already XXL */
#welcome-modal {
  position: fixed; top: 50%; left: 50%;
  transform: translate(-50%,-50%);
  width: 92vw; max-width: 1080px;               /* consolidated size */
  max-height: calc(100vh - 8vh);
  padding: 4.25rem 4.25rem 3.5rem;
  background: rgba(0,0,0,.95);
  border-radius: 1.4rem;
  box-shadow: 0 16px 36px rgba(0,0,0,.8);
  z-index: 2000;
  flex-direction: column; align-items: center; gap: 1.5rem;
  overflow: auto;
}

/* Welcome content sizing (consolidated XXL + bump) */
.welcome-card { display: flex; flex-direction: column; align-items: center; text-align: center; position: relative }
.welcome-avatar { width: 280px; height: 280px; border-radius: 50%; object-fit: cover }
.welcome-card h1 { font-size: clamp(3.6rem, 2.4rem + 2.6vw, 5.4rem); margin: 0; line-height: 1.04; }
.welcome-card p  { font-size: clamp(1.18rem, 1.05rem + .40vw, 1.50rem); margin: .5rem 0; line-height: 1.4; }

.welcome-links {
  display: grid; grid-template-columns: repeat(3,1fr);
  gap: 1rem 2rem; list-style: none; padding: 0; margin: 1.35rem 0 0;
}
.welcome-links a {
  display: inline-flex; align-items: center; gap: .5rem;
  font-size: 1.34rem;
  color: #4e8cff !important;
  fill: currentColor;
  text-decoration: none;
  transition: color 0.15s;
}
.welcome-links a:hover { color: #75aaff !important; fill: #75aaff; text-decoration: underline }
.svg-icon { display: inline-flex; vertical-align: middle; margin-right: 0.4em; width: 1.2em; height: 1.2em; }
.svg-icon svg { width: 1.2em; height: 1.2em; display: block; }

#welcome-close { position: absolute; top: .5rem; right: .75rem; background: none; border: none; font-size: 3.2rem; color: #ccc; cursor: pointer }
#welcome-close:hover { color: #fff }

/* Light-mode welcome card (keep white look) */
:root[data-theme="light"] #welcome-modal {
  background: rgba(255,255,255,0.98) !important;
  box-shadow: 0 16px 36px rgba(0,0,0,0.2) !important;
}
:root[data-theme="light"] #welcome-modal p,
:root[data-theme="light"] #welcome-modal li,
:root[data-theme="light"] #welcome-modal small { color: #111 !important; }
:root[data-theme="light"] #welcome-close { color: #666 !important; }
:root[data-theme="light"] #welcome-close:hover { color: #000 !important; }

/* Small screens/short heights */
@media (max-width: 480px){
  #welcome-modal{ width: 92vw; max-width: none; padding: 2rem; }
  .welcome-avatar{ width: 150px; height: 150px; }
  .welcome-links a{ font-size: 1.12rem; }
}
@media (max-height: 600px){
  #welcome-modal{ padding: 2.25rem; }
  .welcome-avatar{ width: 170px; height: 170px; }
}
/* Ultra-wide */
@media (min-width: 1400px){
  #welcome-modal{ max-width: 1200px; }
  .welcome-avatar{ width: 320px; height: 320px; }
  .welcome-card h1{ font-size: clamp(3.9rem, 2rem + 3.2vw, 5.8rem); }
}

/* ====== ABOUT PILL ====== */
.about-btn {
  font-family: inherit;
  font-size: 1rem;
  font-weight: 500;
  color: inherit;
  background: rgba(255,255,255,0.17);
  border: none;
  border-radius: 0.7rem;
  padding: 0.28em 1.1em;
  margin-left: 1rem;
  cursor: pointer;
  transition: background 0.18s, color 0.18s;
  line-height: 1.13;
  box-shadow: none;
  letter-spacing: 0.01em;
  display: inline-block;
  vertical-align: middle;
}
.about-btn:hover, .about-btn:focus {
  background: rgba(255,255,255,0.28);
  color: inherit;
  text-decoration: none;
}

/* ====== SOCIAL ICONS ====== */
/* Dark default: white => blue on hover */
:root:not([data-theme="light"]) .social_links a,
:root:not([data-theme="light"]) header .social_links a,
:root:not([data-theme="light"]) .dash-header .social_links a {
  color: #fff !important;
  background: none !important;
  transition: color 0.17s;
}
:root:not([data-theme="light"]) .social_links a:hover,
:root:not([data-theme="light"]) header .social_links a:hover,
:root:not([data-theme="light"]) .dash-header .social_links a:hover {
  color: #4e8cff !important;
}

/* ====== LIGHT THEME — TOKENS & OVERRIDES ====== */
:root[data-theme="light"] {
  --text-main:   #222;
  --text-dim:    #5b5b5b;
  --overlay-bg:  rgba(255,255,255,0.92);

  /* Titles */
  --title-pink:   #ff4da6;
  --title-pink-h: #cc0077;

  /* Tags (green style) */
  --tag-bg:      #e8f5ee;
  --tag-text:    #2a915a;
  --tag-border:  #c6ead7;

  /* Social */
  --icon:        #111;
  --icon-hover:  #2a66d4;

  /* Search */
  --search-bg:   #f5f7fb;
  --search-bd:   #d9dfeb;
  --search-ph:   #9aa6b2;
}

/* Light: overlay + text */
:root[data-theme="light"] .page-content .wrapper {
  background: var(--overlay-bg) !important;
  color: var(--text-main) !important;
}
:root[data-theme="light"] .page-content .wrapper p,
:root[data-theme="light"] .page-content .wrapper li { color: var(--text-main) !important; }
:root[data-theme="light"] .page-content .wrapper .post-meta,
:root[data-theme="light"] .page-content .wrapper .post__meta { color: var(--text-dim) !important; }

/* Light: post titles = pink */
:root[data-theme="light"] .page-content .wrapper .post-link,
:root[data-theme="light"] a.post-link,
:root[data-theme="light"] .post-title a,
:root[data-theme="light"] h1.post-title a,
:root[data-theme="light"] .posts .post-title a {
  color: var(--title-pink) !important;
  text-decoration: none !important;
}
:root[data-theme="light"] .page-content .wrapper .post-link:hover,
:root[data-theme="light"] a.post-link:hover,
:root[data-theme="light"] .post-title a:hover,
:root[data-theme="light"] h1.post-title a:hover,
:root[data-theme="light"] .posts .post-title a:hover {
  color: var(--title-pink-h) !important;
  text-decoration: underline !important;
}

/* Light: site title black, chevron blue */
:root[data-theme="light"] .site-title { color: #111 !important; font-weight: 700; }
:root[data-theme="light"] .site-title a { color: inherit !important; text-decoration: none !important; }
:root[data-theme="light"] .site-title a:hover { opacity: 0.85; }
:root[data-theme="light"] .site-title::after,
:root[data-theme="light"] .site-title > span,
:root[data-theme="light"] .site-title .chevron,
:root[data-theme="light"] .site-title a > span { color: #4e8cff !important; }

/* Light: headings if theme overrides */
:root[data-theme="light"] .recent-articles .recent-header h2 { color: #2a66d4 !important; }

/* Light: tags */
:root[data-theme="light"] .page-content .wrapper .tag,
:root[data-theme="light"] .page-content .wrapper .post-tag,
:root[data-theme="light"] .page-content .wrapper .label {
  background: var(--tag-bg) !important;
  color: var(--tag-text) !important;
  border: 1px solid var(--tag-border) !important;
  box-shadow: none !important;
  background-clip: padding-box !important;
}

/* Light: search box */
:root[data-theme="light"] #article-search {
  background-color: var(--search-bg) !important;
  border: 1px solid var(--search-bd) !important;
  color: var(--text-main) !important;
}
:root[data-theme="light"] #article-search::placeholder { color: var(--search-ph) !important; }

/* Light: social icons */
:root[data-theme="light"] .social_links a,
:root[data-theme="light"] header .social_links a,
:root[data-theme="light"] .dash-header .social_links a {
  color: var(--icon) !important;
  background: transparent !important;
}
:root[data-theme="light"] .social_links a:hover,
:root[data-theme="light"] header .social_links a:hover,
:root[data-theme="light"] .dash-header .social_links a:hover {
  color: var(--icon-hover) !important;
}

/* ====== DARK GUARD (overlay color intact) ====== */
:root:not([data-theme="light"]) .page-content .wrapper {
  background: rgba(0,0,0,0.98) !important;
  color: inherit !important;
}

/* Light tweak for About pill */
:root[data-theme="light"] .about-btn {
  background: rgba(0,0,0,0.08) !important;
  color: #111 !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
:root[data-theme="light"] .about-btn:hover { background: rgba(0,0,0,0.14) !important; }

/* ===== LIGHT MODE: remove header/footer pill (no blur/shadow/radius) ===== */
:root[data-theme="light"] .site-header,
:root[data-theme="light"] .site-header .wrapper,
:root[data-theme="light"] .site-footer,
:root[data-theme="light"] .site-footer .wrapper {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}
:root[data-theme="light"] .site-header::before,
:root[data-theme="light"] .site-header::after,
:root[data-theme="light"] .site-footer::before,
:root[data-theme="light"] .site-footer::after { content: none !important; }

/* =========================================================
   FOOTER CREDIT — unified (links same color, no underline)
   Both themes = rgba(255,255,255,0.70) for readability
   ========================================================= */
:root:not([data-theme="light"]) .site-footer,
:root:not([data-theme="light"]) .site-footer a,
:root:not([data-theme="light"]) .site-footer a:visited,
:root[data-theme="light"] .site-footer,
:root[data-theme="light"] .site-footer a,
:root[data-theme="light"] .site-footer a:visited {
  color: rgba(255,255,255,0.70) !important;
  text-decoration: none !important;
}
.site-footer a:hover,
.site-footer a:focus-visible { opacity: .85; }
.site-footer a:active,
.site-footer a:visited { color: inherit !important; }

/* --- MOBILE: PORTRAIT (điện thoại cầm dọc) --- */
@media (max-width: 600px) and (orientation: portrait) {
  /* Search box ~85% bề ngang, tránh tràn viền phải */
  #article-search,
  input#article-search,
  .recent-articles input[type="search"] {
    width: 85% !important;
    max-width: 85% !important;
  }

  /* Icon MXH ~30px, gọn và thẳng hàng */
  .social_links a {
    font-size: 30px !important;
    width: 38px; height: 38px;
    line-height: 38px;
    display: inline-flex; align-items: center; justify-content: center;
    border-radius: 8px;
  }

  /* Nút About Me gọn lại (đỡ “béo”) */
  .about-btn {
    font-size: 14px !important;
    padding: .28em .9em !important;
    border-radius: .6rem !important;
  }

  /* Ẩn widget khi cầm dọc */
  #spotify-player-wrapper,
  #schedule-bar { display: none !important; }
}

/* --- MOBILE: LANDSCAPE (điện thoại xoay ngang) --- */
/* Nhắm đúng điện thoại (chiều cao thấp), tránh ảnh hưởng tablet */
@media (orientation: landscape) and (max-height: 480px) {
  /* Hiện widget và thu nhỏ lại */
  #spotify-player-wrapper,
  #schedule-bar { display: block !important; position: fixed !important; right: 10px; z-index: 1000; }

  #spotify-player-wrapper {
    width: 360px !important;
    height: 420px !important;
    bottom: 12px !important;
  }

  #schedule-bar {
    width: 360px !important;
    height: 170px !important;
    bottom: calc(12px + 420px + 8px) !important; /* nằm trên Spotify */
  }

  /* Chừa chỗ bên phải cho 2 widget */
  .page-content .wrapper {
    margin-right: calc(360px + 24px) !important;
    max-width: none !important; /* tránh bị bó cứng độ rộng */
  }

  /* Search không quá dài trong landscape */
  #article-search,
  input#article-search,
  .recent-articles input[type="search"] {
    width: 60% !important;
    max-width: 60% !important;
  }

  /* Icon MXH giữ kích thước hợp lý khi ngang */
  .social_links a { font-size: 28px !important; width: 36px; height: 36px; line-height: 36px; }
  .about-btn { font-size: 14px !important; padding: .28em .9em !important; }
}
/* ---- MOBILE PORTRAIT: fix hàng Recent + ô search ---- */
@media (max-width: 600px) and (orientation: portrait) {
  /* Cho tiêu đề và ô search được xuống dòng, bỏ padding phải gây tràn */
  .recent-articles .recent-header{
    flex-wrap: wrap !important;
    gap: .6rem 1rem !important;
    padding-right: 0 !important;
  }

  /* Ép input chiếm 85% hàng, không nở ra toàn bộ do flex */
  .recent-articles .recent-header #article-search,
  .recent-articles .recent-header input[type="search"]{
    flex: 0 0 85% !important; /* quan trọng nhất */
    width: 85% !important;
    max-width: 85% !important;
  }
}
/* ===== FIX MOBILE — DROP-IN PATCH (put at the very end) ===== */

/* Reset width mặc định để mobile override thắng */
#article-search,
.recent-articles .recent-header input[type="search"],
.recent-articles input[type="search"]{
  width: 100%;
}

/* Desktop/Tablet: khôi phục clamp như cũ */
@media (min-width: 700px){
  #article-search,
  .recent-articles .recent-header input[type="search"]{
    width: clamp(350px, 60%, 800px);
  }
}

/* MOBILE PORTRAIT (điện thoại cầm dọc) */
@media (max-width: 600px) and (orientation: portrait){

  /* Cho "Recent Articles" + ô search xuống hàng gọn, không tràn */
  .recent-articles .recent-header{
    flex-wrap: wrap !important;
    gap: .6rem 1rem !important;
    padding-right: 0 !important;
  }

  /* Ô search = 85% bề ngang, không bị flex kéo giãn */
  .recent-articles .recent-header input[type="search"],
  #article-search{
    flex: 0 0 85% !important;
    width: 85% !important;
    max-width: 85% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Icon MXH và About Me gọn hơn */
  .social_links a{
    font-size: 30px !important;
    width: 38px; height: 38px; line-height: 38px;
    display: inline-flex; align-items: center; justify-content: center;
    border-radius: 8px;
  }
  .about-btn{
    font-size: 14px !important;
    padding: .28em .9em !important;
    border-radius: .6rem !important;
  }

  /* Ẩn widget khi cầm dọc */
  #spotify-player-wrapper, #schedule-bar{ display: none !important; }
}
